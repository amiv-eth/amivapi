language: python
python: 3.6
services:
  - mongodb
addons:
  apt:
    sources:
      - mongodb-upstart
      - mongodb-3.2-precise
    packages:
      - mongodb-org-server
      - mongodb-org-shell
env:
  - TOX_ENV=py35
  - TOX_ENV=py36
  - TOX_ENV=flake8
install: pip install tox coveralls
script:
  - tox -e $TOX_ENV
before_script:
  - sleep 15  # Travis recommends this to avoid problems
  - mongo test_amivapi --eval 'db.createUser({user:"test_user",pwd:"test_pw",roles:["readWrite"]});'
branches:
  only:
    - master
after_success:
  coveralls
